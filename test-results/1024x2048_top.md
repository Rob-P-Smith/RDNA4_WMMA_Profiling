# Top 5 Configs per Batch Size - 1024x2048 Matrix

**Matrix Dimensions**: N=1024, K=2048

⚠️ = High variance (CV > 0.5) - potentially unreliable/aberrant

**Stable** = Config with lowest CV (most stable) for this batch size (shown if not in top 5)

---

## Batch Size: 16

| Rank | Config | Mean TOPS | Min | Q1 | Q3 | Max | CV |
|------|--------|-----------|-----|-----|-----|-----|-----|
| 1 | `M16_N32_K128_G16_W4_KP2` | 1.02 | 0.92 | 1.01 | 1.03 | 1.04 | 0.124 |
| 2 | `M16_N32_K128_G1_W4_KP4` | 1.01 | 0.81 | 1.00 | 1.03 | 1.05 | 0.236 |
| 3 | `M16_N32_K128_G8_W4_KP4` | 1.01 | 0.91 | 1.00 | 1.02 | 1.04 | 0.128 |
| 4 | `M16_N32_K128_G1_W4_KP1` | 1.01 | 0.95 | 1.00 | 1.02 | 1.05 | 0.105 |
| 5 | `M16_N32_K128_G1_W4_KP2` | 1.01 | 0.88 | 1.00 | 1.02 | 1.04 | 0.158 |
| **Stable** | `M128_N128_K64_G8_W4_KP2` | 0.23 | 0.22 | 0.23 | 0.23 | 0.23 | 0.037 |

## Batch Size: 32

| Rank | Config | Mean TOPS | Min | Q1 | Q3 | Max | CV |
|------|--------|-----------|-----|-----|-----|-----|-----|
| 1 | `M128_N16_K128_G16_W4_KP1` | 1.93 | 1.59 | 1.92 | 1.97 | 2.08 | 0.254 |
| 2 | `M16_N16_K128_G16_W4_KP2` | 1.92 | 1.69 | 1.92 | 1.94 | 1.97 | 0.146 |
| 3 | `M128_N16_K128_G32_W4_KP2` | 1.92 | 1.75 | 1.92 | 1.94 | 1.96 | 0.111 |
| 4 | `M16_N16_K128_G1_W4_KP4` | 1.92 | 1.71 | 1.90 | 1.95 | 1.98 | 0.138 |
| 5 | `M16_N32_K128_G2_W4_KP4` | 1.92 | 1.78 | 1.90 | 1.93 | 1.97 | 0.096 |
| **Stable** | `M64_N32_K16_G8_W4_KP2` | 1.18 | 1.14 | 1.18 | 1.19 | 1.20 | 0.045 |

## Batch Size: 64

| Rank | Config | Mean TOPS | Min | Q1 | Q3 | Max | CV |
|------|--------|-----------|-----|-----|-----|-----|-----|
| 1 | `M128_N16_K128_G4_W4_KP2` | 3.91 | 3.20 | 3.90 | 3.96 | 4.04 | 0.214 |
| 2 | `M128_N16_K128_G2_W4_KP1` | 3.87 | 2.93 | 3.86 | 3.92 | 3.98 | 0.272 |
| 3 | `M128_N16_K128_G4_W4_KP4` | 3.86 | 2.96 | 3.85 | 3.91 | 3.98 | 0.262 |
| 4 | `M128_N16_K128_G2_W4_KP2` | 3.86 | 2.46 | 3.89 | 3.95 | 4.00 | 0.398 |
| 5 | `M128_N16_K128_G1_W4_KP2` | 3.85 | 2.64 | 3.85 | 3.90 | 4.07 | 0.371 |
| **Stable** | `M64_N64_K16_G16_W4_KP2` | 1.97 | 1.89 | 1.96 | 1.98 | 2.00 | 0.054 |

## Batch Size: 128

| Rank | Config | Mean TOPS | Min | Q1 | Q3 | Max | CV |
|------|--------|-----------|-----|-----|-----|-----|-----|
| 1 | `M128_N16_K128_G2_W4_KP2` | 7.75 | 6.23 | 7.74 | 7.87 | 8.21 | 0.255 |
| 2 | `M128_N16_K128_G4_W4_KP2` | 7.71 | 4.87 | 7.76 | 7.89 | 8.01 | 0.407 |
| 3 | `M128_N16_K128_G4_W4_KP4` | 7.70 | 4.96 | 7.69 | 7.81 | 8.10 | 0.408 |
| 4 | `M128_N16_K128_G1_W4_KP2` | 7.68 | 6.31 | 7.62 | 7.78 | 7.87 | 0.204 |
| 5 | `M128_N16_K128_G2_W4_KP1` | 7.64 | 1.89 | 7.66 | 7.80 | 7.88 | 0.784 ⚠️ |
| **Stable** | `M128_N128_K32_G8_W4_KP4` | 1.26 | 1.22 | 1.26 | 1.27 | 1.28 | 0.045 |

## Batch Size: 256

| Rank | Config | Mean TOPS | Min | Q1 | Q3 | Max | CV |
|------|--------|-----------|-----|-----|-----|-----|-----|
| 1 | `M128_N32_K128_G16_W4_KP2` | 14.71 | 4.37 | 14.72 | 15.10 | 15.37 | 0.748 ⚠️ |
| 2 | `M128_N32_K128_G1_W4_KP4` | 14.65 | 4.28 | 14.58 | 15.07 | 15.37 | 0.758 ⚠️ |
| 3 | `M128_N32_K128_G32_W4_KP2` | 14.61 | 3.73 | 14.52 | 15.02 | 15.33 | 0.794 ⚠️ |
| 4 | `M128_N32_K128_G16_W4_KP4` | 14.59 | 3.73 | 14.73 | 15.03 | 15.31 | 0.794 ⚠️ |
| 5 | `M128_N16_K128_G1_W4_KP1` | 14.57 | 4.15 | 14.62 | 14.93 | 15.09 | 0.751 ⚠️ |
| **Stable** | `M128_N128_K128_G16_W4_KP4` | 4.31 | 4.22 | 4.30 | 4.32 | 4.34 | 0.028 |

## Batch Size: 512

| Rank | Config | Mean TOPS | Min | Q1 | Q3 | Max | CV |
|------|--------|-----------|-----|-----|-----|-----|-----|
| 1 | `M128_N32_K128_G8_W4_KP2` | 27.73 | 7.40 | 27.80 | 28.25 | 28.64 | 0.766 ⚠️ |
| 2 | `M128_N32_K128_G16_W4_KP2` | 27.71 | 7.47 | 27.81 | 28.39 | 28.77 | 0.768 ⚠️ |
| 3 | `M128_N32_K128_G1_W4_KP2` | 27.62 | 7.70 | 27.71 | 28.40 | 29.07 | 0.774 ⚠️ |
| 4 | `M128_N32_K128_G16_W4_KP1` | 27.50 | 7.79 | 27.55 | 28.22 | 28.85 | 0.766 ⚠️ |
| 5 | `M128_N32_K128_G32_W4_KP1` | 27.48 | 7.78 | 27.47 | 28.35 | 28.90 | 0.769 ⚠️ |
| **Stable** | `M128_N128_K64_G1_W4_KP4` | 7.13 | 6.91 | 7.12 | 7.17 | 7.20 | 0.041 |

## Batch Size: 1024

| Rank | Config | Mean TOPS | Min | Q1 | Q3 | Max | CV |
|------|--------|-----------|-----|-----|-----|-----|-----|
| 1 | `M128_N32_K128_G8_W4_KP1` | 46.36 | 17.11 | 46.22 | 47.46 | 48.60 | 0.679 ⚠️ |
| 2 | `M128_N32_K128_G32_W4_KP2` | 46.35 | 13.99 | 46.18 | 47.53 | 48.44 | 0.743 ⚠️ |
| 3 | `M128_N32_K128_G32_W4_KP4` | 46.29 | 15.99 | 46.16 | 47.17 | 48.65 | 0.706 ⚠️ |
| 4 | `M128_N64_K64_G32_W4_KP2` | 46.16 | 16.46 | 46.15 | 47.23 | 48.80 | 0.701 ⚠️ |
| 5 | `M128_N32_K128_G4_W4_KP4` | 46.11 | 15.26 | 45.99 | 47.29 | 48.36 | 0.718 ⚠️ |
| **Stable** | `M128_N128_K64_G4_W4_KP4` | 14.12 | 13.68 | 14.11 | 14.17 | 14.20 | 0.037 |

## Batch Size: 2048

| Rank | Config | Mean TOPS | Min | Q1 | Q3 | Max | CV |
|------|--------|-----------|-----|-----|-----|-----|-----|
| 1 | `M128_N32_K128_G8_W4_KP4` | 71.83 | 26.17 | 72.08 | 73.13 | 74.09 | 0.667 ⚠️ |
| 2 | `M128_N32_K128_G32_W4_KP4` | 71.20 | 25.58 | 70.95 | 72.74 | 73.67 | 0.675 ⚠️ |
| 3 | `M128_N32_K128_G16_W4_KP1` | 71.18 | 26.02 | 71.57 | 73.33 | 74.49 | 0.681 ⚠️ |
| 4 | `M128_N32_K128_G16_W4_KP2` | 71.10 | 30.69 | 70.77 | 72.78 | 75.55 | 0.631 ⚠️ |
| 5 | `M128_N32_K128_G16_W4_KP4` | 71.08 | 25.57 | 71.20 | 72.80 | 74.17 | 0.684 ⚠️ |
| **Stable** | `M16_N16_K64_G1_W4_KP1` | 17.66 | 17.13 | 17.48 | 17.83 | 18.23 | 0.062 |

## Batch Size: 4096

| Rank | Config | Mean TOPS | Min | Q1 | Q3 | Max | CV |
|------|--------|-----------|-----|-----|-----|-----|-----|
| 1 | `M128_N32_K128_G8_W4_KP1` | 98.54 | 48.96 | 98.20 | 100.66 | 102.50 | 0.543 ⚠️ |
| 2 | `M128_N32_K128_G16_W4_KP2` | 98.53 | 45.80 | 97.97 | 100.74 | 101.88 | 0.569 ⚠️ |
| 3 | `M128_N32_K128_G4_W4_KP4` | 97.91 | 48.51 | 97.99 | 100.18 | 101.86 | 0.545 ⚠️ |
| 4 | `M128_N32_K128_G16_W4_KP1` | 97.77 | 43.90 | 97.83 | 100.24 | 101.57 | 0.590 ⚠️ |
| 5 | `M128_N32_K128_G8_W4_KP2` | 97.22 | 44.38 | 97.23 | 100.33 | 102.85 | 0.601 ⚠️ |
| **Stable** | `M16_N32_K16_G4_W4_KP2` | 10.14 | 9.80 | 10.08 | 10.16 | 10.48 | 0.067 |

---

## Summary

- **Matrix Size**: 1024x2048
- **Total Configs Tested**: 1104
- **Batch Sizes**: 16, 32, 64, 128, 256, 512, 1024, 2048, 4096
- **K-dimension values in top configs**: [128]
