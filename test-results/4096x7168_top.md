# Top 5 Configs per Batch Size - 4096x7168 Matrix

**Matrix Dimensions**: N=4096, K=7168

⚠️ = High variance (CV > 0.5) - potentially unreliable/aberrant

**Stable** = Config with lowest CV (most stable) for this batch size (shown if not in top 5)

---

## Batch Size: 16

| Rank | Config | Mean TOPS | Min | Q1 | Q3 | Max | CV |
|------|--------|-----------|-----|-----|-----|-----|-----|
| 1 | `M16_N32_K128_G2_W4_KP2` | 6.29 | 2.85 | 6.24 | 6.44 | 6.62 | 0.600 ⚠️ |
| 2 | `M16_N32_K128_G8_W4_KP2` | 6.27 | 3.46 | 6.20 | 6.44 | 6.66 | 0.511 ⚠️ |
| 3 | `M16_N32_K128_G2_W4_KP4` | 6.26 | 2.83 | 6.23 | 6.43 | 6.58 | 0.599 ⚠️ |
| 4 | `M16_N32_K128_G4_W4_KP4` | 6.25 | 2.82 | 6.24 | 6.40 | 6.61 | 0.607 ⚠️ |
| 5 | `M16_N32_K128_G1_W4_KP1` | 6.24 | 2.94 | 6.21 | 6.43 | 6.61 | 0.587 ⚠️ |
| **Stable** | `M32_N128_K128_G4_W4_KP4` | 4.35 | 4.23 | 4.34 | 4.37 | 4.44 | 0.049 |

## Batch Size: 32

| Rank | Config | Mean TOPS | Min | Q1 | Q3 | Max | CV |
|------|--------|-----------|-----|-----|-----|-----|-----|
| 1 | `M128_N32_K128_G4_W4_KP1` | 11.81 | 9.83 | 11.57 | 12.03 | 12.44 | 0.222 |
| 2 | `M128_N32_K128_G2_W4_KP1` | 11.80 | 10.00 | 11.64 | 12.05 | 12.60 | 0.220 |
| 3 | `M128_N32_K128_G8_W4_KP2` | 11.78 | 10.12 | 11.57 | 12.07 | 12.53 | 0.204 |
| 4 | `M128_N32_K128_G2_W4_KP4` | 11.78 | 9.75 | 11.60 | 12.04 | 12.38 | 0.224 |
| 5 | `M128_N32_K128_G4_W4_KP4` | 11.77 | 9.91 | 11.53 | 12.02 | 12.47 | 0.218 |
| **Stable** | `M128_N128_K64_G16_W4_KP2` | 2.25 | 2.24 | 2.25 | 2.26 | 2.26 | 0.009 |

## Batch Size: 64

| Rank | Config | Mean TOPS | Min | Q1 | Q3 | Max | CV |
|------|--------|-----------|-----|-----|-----|-----|-----|
| 1 | `M128_N32_K128_G16_W4_KP2` | 24.33 | 22.67 | 24.02 | 24.71 | 25.35 | 0.110 |
| 2 | `M128_N32_K128_G1_W4_KP4` | 24.19 | 21.11 | 23.96 | 24.69 | 25.39 | 0.177 |
| 3 | `M128_N32_K128_G1_W4_KP1` | 24.17 | 21.44 | 23.86 | 24.74 | 25.31 | 0.160 |
| 4 | `M128_N32_K128_G1_W4_KP2` | 24.17 | 19.09 | 23.81 | 24.65 | 25.68 | 0.273 |
| 5 | `M128_N32_K128_G8_W4_KP4` | 24.17 | 19.77 | 23.72 | 24.76 | 25.32 | 0.230 |
| **Stable** | `M128_N128_K64_G8_W4_KP1` | 4.51 | 4.48 | 4.51 | 4.52 | 4.53 | 0.013 |

## Batch Size: 128

| Rank | Config | Mean TOPS | Min | Q1 | Q3 | Max | CV |
|------|--------|-----------|-----|-----|-----|-----|-----|
| 1 | `M128_N32_K128_G2_W4_KP4` | 47.75 | 40.20 | 47.17 | 48.65 | 49.63 | 0.198 |
| 2 | `M128_N32_K128_G2_W4_KP1` | 47.65 | 44.55 | 47.21 | 48.37 | 49.54 | 0.105 |
| 3 | `M128_N32_K128_G1_W4_KP2` | 47.56 | 44.09 | 46.99 | 48.23 | 49.76 | 0.119 |
| 4 | `M128_N32_K128_G32_W4_KP1` | 47.51 | 43.70 | 46.71 | 48.26 | 49.99 | 0.132 |
| 5 | `M128_N32_K128_G16_W4_KP4` | 47.49 | 44.05 | 46.86 | 48.29 | 50.28 | 0.131 |
| **Stable** | `M128_N128_K64_G2_W4_KP1` | 9.01 | 8.95 | 9.01 | 9.03 | 9.04 | 0.010 |

## Batch Size: 256

| Rank | Config | Mean TOPS | Min | Q1 | Q3 | Max | CV |
|------|--------|-----------|-----|-----|-----|-----|-----|
| 1 | `M128_N32_K128_G32_W4_KP4` | 78.77 | 64.10 | 76.74 | 81.02 | 84.52 | 0.259 |
| 2 | `M128_N32_K128_G32_W4_KP1` | 78.44 | 65.67 | 75.99 | 81.34 | 84.63 | 0.242 |
| 3 | `M128_N32_K128_G32_W4_KP2` | 77.58 | 66.34 | 75.80 | 79.56 | 83.58 | 0.222 |
| 4 | `M64_N32_K128_G32_W4_KP4` | 76.57 | 64.26 | 75.68 | 78.24 | 79.59 | 0.200 |
| 5 | `M64_N32_K128_G32_W4_KP1` | 76.24 | 68.09 | 75.42 | 77.67 | 79.12 | 0.145 |
| **Stable** | `M128_N128_K64_G32_W4_KP2` | 17.84 | 17.59 | 17.82 | 17.87 | 17.92 | 0.018 |

## Batch Size: 512

| Rank | Config | Mean TOPS | Min | Q1 | Q3 | Max | CV |
|------|--------|-----------|-----|-----|-----|-----|-----|
| 1 | `M128_N32_K128_G32_W4_KP4` | 113.30 | 98.89 | 113.13 | 115.04 | 116.96 | 0.160 |
| 2 | `M128_N32_K128_G32_W4_KP1` | 113.30 | 98.66 | 113.24 | 115.23 | 117.26 | 0.164 |
| 3 | `M128_N32_K128_G8_W4_KP1` | 112.93 | 96.27 | 112.70 | 114.25 | 116.28 | 0.177 |
| 4 | `M128_N32_K128_G8_W4_KP4` | 112.86 | 102.76 | 112.37 | 114.00 | 115.38 | 0.112 |
| 5 | `M128_N32_K128_G32_W4_KP2` | 112.83 | 96.83 | 112.83 | 114.86 | 116.92 | 0.178 |
| **Stable** | `M64_N16_K16_G4_W4_KP1` | 11.77 | 11.62 | 11.75 | 11.80 | 11.86 | 0.020 |

## Batch Size: 1024

| Rank | Config | Mean TOPS | Min | Q1 | Q3 | Max | CV |
|------|--------|-----------|-----|-----|-----|-----|-----|
| 1 | `M128_N32_K128_G8_W4_KP2` | 129.38 | 121.52 | 126.55 | 132.43 | 136.11 | 0.113 |
| 2 | `M128_N32_K128_G16_W4_KP1` | 129.20 | 123.01 | 126.54 | 131.35 | 135.70 | 0.098 |
| 3 | `M128_N32_K128_G8_W4_KP1` | 128.96 | 114.15 | 126.57 | 131.72 | 135.02 | 0.162 |
| 4 | `M128_N32_K128_G8_W4_KP4` | 128.85 | 117.48 | 126.35 | 131.74 | 134.74 | 0.134 |
| 5 | `M128_N32_K128_G4_W4_KP1` | 128.81 | 122.31 | 126.54 | 130.78 | 133.12 | 0.084 |
| **Stable** | `M16_N16_K128_G1_W4_KP4` | 11.02 | 10.94 | 11.00 | 11.03 | 11.12 | 0.016 |

## Batch Size: 2048

| Rank | Config | Mean TOPS | Min | Q1 | Q3 | Max | CV |
|------|--------|-----------|-----|-----|-----|-----|-----|
| 1 | `M128_N32_K128_G4_W4_KP1` | 134.91 | 127.30 | 133.01 | 136.52 | 142.58 | 0.113 |
| 2 | `M128_N32_K128_G4_W4_KP2` | 134.81 | 129.22 | 132.97 | 136.42 | 141.55 | 0.091 |
| 3 | `M128_N32_K128_G4_W4_KP4` | 134.74 | 125.95 | 132.61 | 137.74 | 142.69 | 0.124 |
| 4 | `M128_N32_K128_G8_W4_KP1` | 134.37 | 126.27 | 132.52 | 135.49 | 141.61 | 0.114 |
| 5 | `M128_N32_K128_G8_W4_KP4` | 134.33 | 127.30 | 132.53 | 135.53 | 143.02 | 0.117 |
| **Stable** | `M16_N32_K64_G1_W4_KP4` | 5.71 | 5.67 | 5.70 | 5.72 | 5.74 | 0.012 |

## Batch Size: 4096

| Rank | Config | Mean TOPS | Min | Q1 | Q3 | Max | CV |
|------|--------|-----------|-----|-----|-----|-----|-----|
| 1 | `M128_N32_K128_G4_W4_KP2` | 127.02 | 119.76 | 125.17 | 128.99 | 132.44 | 0.100 |
| 2 | `M128_N32_K128_G4_W4_KP4` | 125.56 | 110.21 | 123.51 | 127.54 | 146.11 | 0.286 |
| 3 | `M128_N32_K128_G4_W4_KP1` | 125.26 | 118.15 | 122.93 | 127.13 | 149.25 | 0.248 |
| 4 | `M128_N32_K128_G8_W4_KP2` | 124.57 | 118.15 | 122.25 | 126.51 | 143.88 | 0.207 |
| 5 | `M128_N32_K128_G8_W4_KP1` | 124.54 | 118.23 | 122.91 | 126.50 | 130.16 | 0.096 |
| **Stable** | `M16_N32_K64_G1_W4_KP2` | 5.71 | 5.69 | 5.71 | 5.72 | 5.73 | 0.007 |

---

## Summary

- **Matrix Size**: 4096x7168
- **Total Configs Tested**: 1104
- **Batch Sizes**: 16, 32, 64, 128, 256, 512, 1024, 2048, 4096
- **K-dimension values in top configs**: [128]
