# Top 5 Configs per Batch Size - 4096x4096 Matrix

**Matrix Dimensions**: N=4096, K=4096

⚠️ = High variance (CV > 0.5) - potentially unreliable/aberrant

**Stable** = Config with lowest CV (most stable) for this batch size (shown if not in top 5)

---

## Batch Size: 16

| Rank | Config | Mean TOPS | Min | Q1 | Q3 | Max | CV |
|------|--------|-----------|-----|-----|-----|-----|-----|
| 1 | `M16_N16_K128_G8_W4_KP1` | 4.02 | 1.94 | 3.98 | 4.14 | 4.37 | 0.605 ⚠️ |
| 2 | `M16_N16_K128_G16_W4_KP2` | 3.99 | 1.68 | 3.96 | 4.12 | 4.38 | 0.675 ⚠️ |
| 3 | `M16_N16_K128_G2_W4_KP2` | 3.99 | 1.92 | 3.94 | 4.10 | 4.49 | 0.643 ⚠️ |
| 4 | `M16_N16_K128_G1_W4_KP2` | 3.99 | 2.18 | 3.95 | 4.09 | 4.28 | 0.526 ⚠️ |
| 5 | `M16_N16_K128_G1_W4_KP4` | 3.99 | 1.67 | 3.94 | 4.08 | 4.35 | 0.672 ⚠️ |
| **Stable** | `M128_N128_K128_G1_W4_KP4` | 1.18 | 1.12 | 1.14 | 1.24 | 1.29 | 0.137 |

## Batch Size: 32

| Rank | Config | Mean TOPS | Min | Q1 | Q3 | Max | CV |
|------|--------|-----------|-----|-----|-----|-----|-----|
| 1 | `M16_N16_K128_G16_W4_KP1` | 8.53 | 6.73 | 8.44 | 8.66 | 8.98 | 0.264 |
| 2 | `M16_N16_K128_G8_W4_KP2` | 8.46 | 3.57 | 8.39 | 8.71 | 9.08 | 0.652 ⚠️ |
| 3 | `M16_N16_K128_G4_W4_KP2` | 8.46 | 3.68 | 8.43 | 8.66 | 8.86 | 0.612 ⚠️ |
| 4 | `M16_N16_K128_G16_W4_KP2` | 8.45 | 3.40 | 8.46 | 8.71 | 8.95 | 0.657 ⚠️ |
| 5 | `M16_N16_K128_G16_W4_KP4` | 8.44 | 3.81 | 8.37 | 8.62 | 8.95 | 0.609 ⚠️ |
| **Stable** | `M128_N128_K16_G16_W4_KP4` | 1.03 | 1.03 | 1.03 | 1.03 | 1.04 | 0.010 |

## Batch Size: 64

| Rank | Config | Mean TOPS | Min | Q1 | Q3 | Max | CV |
|------|--------|-----------|-----|-----|-----|-----|-----|
| 1 | `M128_N32_K128_G4_W4_KP2` | 16.78 | 14.51 | 16.58 | 17.06 | 17.61 | 0.185 |
| 2 | `M128_N32_K128_G2_W4_KP1` | 16.76 | 13.88 | 16.65 | 16.98 | 17.34 | 0.206 |
| 3 | `M128_N32_K128_G4_W4_KP1` | 16.71 | 13.90 | 16.57 | 16.91 | 17.61 | 0.222 |
| 4 | `M128_N32_K128_G8_W4_KP4` | 16.71 | 14.60 | 16.56 | 16.91 | 17.51 | 0.174 |
| 5 | `M16_N32_K128_G4_W4_KP1` | 16.68 | 7.04 | 16.68 | 17.15 | 17.68 | 0.638 ⚠️ |
| **Stable** | `M128_N128_K16_G1_W4_KP2` | 2.05 | 2.04 | 2.05 | 2.06 | 2.06 | 0.008 |

## Batch Size: 128

| Rank | Config | Mean TOPS | Min | Q1 | Q3 | Max | CV |
|------|--------|-----------|-----|-----|-----|-----|-----|
| 1 | `M128_N32_K128_G8_W4_KP4` | 32.97 | 26.33 | 32.71 | 33.42 | 34.69 | 0.254 |
| 2 | `M128_N32_K128_G1_W4_KP1` | 32.89 | 25.57 | 32.65 | 33.34 | 35.41 | 0.299 |
| 3 | `M128_N16_K128_G4_W4_KP1` | 32.89 | 25.97 | 32.20 | 33.67 | 35.16 | 0.279 |
| 4 | `M128_N32_K128_G4_W4_KP2` | 32.88 | 26.94 | 32.69 | 33.41 | 35.20 | 0.251 |
| 5 | `M128_N16_K128_G8_W4_KP1` | 32.85 | 26.91 | 32.23 | 33.56 | 34.94 | 0.244 |
| **Stable** | `M128_N128_K32_G8_W4_KP4` | 5.17 | 5.12 | 5.16 | 5.18 | 5.19 | 0.014 |

## Batch Size: 256

| Rank | Config | Mean TOPS | Min | Q1 | Q3 | Max | CV |
|------|--------|-----------|-----|-----|-----|-----|-----|
| 1 | `M64_N32_K128_G4_W4_KP2` | 59.41 | 32.45 | 59.11 | 60.48 | 62.16 | 0.500 |
| 2 | `M64_N32_K128_G4_W4_KP1` | 59.37 | 27.16 | 58.91 | 60.62 | 62.07 | 0.588 ⚠️ |
| 3 | `M64_N32_K128_G16_W4_KP1` | 59.17 | 26.92 | 58.79 | 60.54 | 62.12 | 0.595 ⚠️ |
| 4 | `M64_N32_K128_G8_W4_KP2` | 59.07 | 29.68 | 58.84 | 60.22 | 61.62 | 0.541 ⚠️ |
| 5 | `M64_N32_K128_G8_W4_KP1` | 58.94 | 26.63 | 58.80 | 60.06 | 61.86 | 0.598 ⚠️ |
| **Stable** | `M16_N128_K32_G1_W4_KP2` | 5.12 | 4.94 | 5.09 | 5.13 | 5.25 | 0.061 |

## Batch Size: 512

| Rank | Config | Mean TOPS | Min | Q1 | Q3 | Max | CV |
|------|--------|-----------|-----|-----|-----|-----|-----|
| 1 | `M128_N32_K128_G32_W4_KP4` | 93.69 | 80.93 | 93.13 | 94.62 | 96.55 | 0.167 |
| 2 | `M128_N32_K128_G8_W4_KP4` | 93.56 | 52.85 | 93.82 | 95.24 | 96.91 | 0.471 |
| 3 | `M128_N32_K128_G4_W4_KP4` | 93.39 | 47.71 | 93.26 | 95.04 | 96.74 | 0.525 ⚠️ |
| 4 | `M128_N32_K128_G8_W4_KP1` | 93.29 | 55.92 | 92.90 | 94.92 | 96.23 | 0.432 |
| 5 | `M128_N32_K128_G8_W4_KP2` | 93.28 | 47.35 | 93.48 | 94.85 | 96.79 | 0.530 ⚠️ |
| **Stable** | `M16_N32_K128_G1_W4_KP1` | 10.22 | 10.12 | 10.19 | 10.24 | 10.51 | 0.038 |

## Batch Size: 1024

| Rank | Config | Mean TOPS | Min | Q1 | Q3 | Max | CV |
|------|--------|-----------|-----|-----|-----|-----|-----|
| 1 | `M128_N32_K128_G32_W4_KP4` | 117.18 | 110.53 | 115.94 | 118.68 | 120.85 | 0.088 |
| 2 | `M128_N32_K128_G32_W4_KP2` | 117.03 | 101.74 | 116.24 | 118.43 | 120.21 | 0.158 |
| 3 | `M128_N32_K128_G8_W4_KP4` | 116.85 | 101.83 | 115.88 | 118.43 | 120.71 | 0.162 |
| 4 | `M128_N32_K128_G32_W4_KP1` | 116.67 | 100.03 | 115.53 | 118.22 | 121.06 | 0.180 |
| 5 | `M128_N32_K128_G8_W4_KP1` | 116.50 | 102.54 | 115.57 | 118.05 | 120.78 | 0.157 |
| **Stable** | `M32_N128_K128_G1_W4_KP1` | 20.41 | 20.11 | 20.37 | 20.48 | 20.55 | 0.022 |

## Batch Size: 2048

| Rank | Config | Mean TOPS | Min | Q1 | Q3 | Max | CV |
|------|--------|-----------|-----|-----|-----|-----|-----|
| 1 | `M128_N32_K128_G8_W4_KP1` | 130.51 | 118.86 | 128.61 | 132.51 | 136.74 | 0.137 |
| 2 | `M128_N32_K128_G8_W4_KP4` | 130.47 | 120.84 | 127.84 | 133.22 | 136.94 | 0.123 |
| 3 | `M128_N32_K128_G8_W4_KP2` | 130.05 | 121.80 | 128.15 | 132.09 | 136.80 | 0.115 |
| 4 | `M128_N32_K128_G4_W4_KP4` | 129.85 | 119.93 | 127.93 | 132.61 | 135.57 | 0.120 |
| 5 | `M128_N32_K128_G4_W4_KP1` | 129.75 | 118.35 | 127.63 | 132.60 | 135.51 | 0.132 |
| **Stable** | `M16_N64_K64_G1_W4_KP2` | 5.11 | 5.06 | 5.09 | 5.12 | 5.15 | 0.017 |

## Batch Size: 4096

| Rank | Config | Mean TOPS | Min | Q1 | Q3 | Max | CV |
|------|--------|-----------|-----|-----|-----|-----|-----|
| 1 | `M128_N32_K128_G8_W4_KP2` | 137.91 | 131.33 | 136.13 | 139.61 | 145.17 | 0.100 |
| 2 | `M128_N32_K128_G8_W4_KP1` | 137.80 | 127.53 | 135.83 | 139.52 | 147.35 | 0.144 |
| 3 | `M128_N32_K128_G8_W4_KP4` | 137.64 | 131.08 | 135.59 | 139.53 | 143.77 | 0.092 |
| 4 | `M128_N32_K128_G4_W4_KP4` | 136.69 | 129.32 | 134.63 | 138.87 | 142.90 | 0.099 |
| 5 | `M128_N32_K128_G4_W4_KP1` | 136.59 | 130.71 | 134.25 | 138.55 | 143.24 | 0.092 |
| **Stable** | `M16_N128_K128_G1_W4_KP4` | 9.38 | 9.35 | 9.37 | 9.39 | 9.43 | 0.009 |

---

## Summary

- **Matrix Size**: 4096x4096
- **Total Configs Tested**: 1104
- **Batch Sizes**: 16, 32, 64, 128, 256, 512, 1024, 2048, 4096
- **K-dimension values in top configs**: [128]
